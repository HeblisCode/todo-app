(()=>{"use strict";const e=function(){const e={};function t(t){return void 0!==e[t]||(console.log(`PubSub says: "${t}" hasn't been published yet!`),!1)}return{subscribe:function(t,n){void 0===e[t]&&(e[t]=[]),e[t].push(n)},unsubscribe:function(n,i){if(!t(n)||!function(t,n){return!(e[t].indexOf(n)<0&&(console.log("PubSub says: no such handler found"),1))}(n,i))return;const s=e[n].indexOf(i);e[n].splice(s,1)},publish:function(n,i){t(n)&&e[n].forEach((e=>e(i)))},debug:function(){console.table(e)}}}(),t=(e,t)=>{const n={name:e,date:t,isDone:!1,id:`taskID${Math.floor(999999*Math.random())}`},i={done(){this.isDone=!0},notDone(){this.isDone=!1},edit(e,t){this.name=e,this.date=t}};return Object.assign(Object.create(i),n)},n=(e,t,n)=>{const i={title:e,description:t,priority:n,completed:!1,id:`projID${Math.floor(999999*Math.random())}`,tasks:[]},s={pushTask(e){this.tasks.push(e)},deleteTask(e){const t=this.tasks.indexOf(e);this.tasks.splice(t,1)},edit(e,t,n){this.title=e,this.description=t,this.priority=n},getTasks(){return this.tasks},checkCompleted(){const e=tasks.sort((e=>e.isDone));tasks.lenght===e.lenght&&(this.completed=!0)}};return Object.assign(Object.create(s),i)},i=function(){const i=[];function s(e){for(let t=0;t<i.length;t++)if(i[t].id===e)return t}function c(e,t){for(let n=0;n<e.tasks.length;n++)if(e.tasks[n].id===t)return n}function d(t){const s=n(t,"","");i.push(s),e.publish("todoDataChanged",i)}return e.subscribe("addProject",d),e.subscribe("deleteProject",(function(t){const n=s(t);i.splice(n,1),e.publish("todoDataChanged",i)})),e.subscribe("deleteTask",(function(t){const n=c(t.project,t.id),d=s(t.project.id);i[d].tasks.splice(n,1),e.publish("todoDataChanged",i)})),e.subscribe("completeTask",(function(t){const n=s(t.projId),d=c(i[n],t.taskId);i[n].tasks[d].done(),e.publish("todoDataChanged",i)})),e.subscribe("incompleteTask",(function(t){const n=s(t.projId),d=c(i[n],t.taskId);i[n].tasks[d].notDone(),e.publish("todoDataChanged",i)})),e.subscribe("editProject",(function(t){const n=s(t.projId);i[n].edit(t.title,t.description,t.priority),e.publish("todoDataChanged",i)})),e.subscribe("editTask",(function(t){const n=s(t.project.id),d=c(t.project,t.taskId);i[n].tasks[d].edit(t.name,t.date),e.publish("todoDataChanged",i)})),e.subscribe("addTask",(function(n){const c=s(n.id);i[c].pushTask(t("Default name","00/00/00")),e.publish("todoDataChanged",i)})),{addProject:d}}(),s=function(e,t){const n=document.createElement("span");if(n.classList.add("material-icons"),n.innerText=e,void 0===t)return n;for(let e in t)console.log(e),console.log(t[e]),n.addEventListener(e,t[e]);return n},c=function(e,t){t.forEach((t=>{e.appendChild(t)}))},d=function(e){const t=document.createElement("input");for(let n in e)t.setAttribute(n,e[n]);return t},o=function(e){const t=document.createElement("p");return t.id=e.id,t.innerText=e.text,void 0===e.class||e.class.forEach((e=>{t.classList.add(e)})),t},a=function(e){const t=document.createElement("div");return t.id=e.id,void 0===e.class||e.class.forEach((e=>{t.classList.add(e)})),t};function r(t,n){const i=document.createElement("form");i.setAttribute("method","dialog");const o=document.createElement("div");o.id="taskButtons";const a=d({type:"text",required:"",name:"name",value:n.name}),r=d({type:"date",required:"",name:"date",value:n.date}),l=s("done",{click:()=>{a.checkValidity()&&r.checkValidity()&&e.publish("editTask",{project:t,taskId:n.id,name:a.value,date:r.value})}}),u=s("close",{click:()=>{e.publish("editTask",{project:t,taskId:n.id,name:n.name,date:n.date})}});return c(o,[l,u]),c(i,[a,r,o]),i}!function(){const t=document.querySelector("nav"),n=document.querySelector("#navProjectsContainer"),i=document.querySelector("main"),d=document.querySelector("header > button"),l=document.querySelector("#addProject"),u=document.querySelector("nav > form"),p={data:null,set(e){this.data=e},get(){return this.data}};function m(t){if(!t)return;i.innerHTML="";const n=function(t){const n=document.createElement("div"),i=document.createElement("h2"),s=document.createElement("div"),d=document.createElement("span"),o=document.createElement("span");return n.id="mainHeader",s.id="mainButtons",d.classList.add("material-icons"),o.classList.add("material-icons"),i.innerText=t.title,d.innerText="delete",o.innerText="edit",o.addEventListener("click",(()=>{e.publish("requestTitleEdit",function(t){const n=document.createElement("form"),i=document.createElement("input"),s=document.createElement("span"),d=document.createElement("span"),o=document.createElement("div");return o.id="mainButtons",i.setAttribute("type","text"),i.setAttribute("required",""),i.setAttribute("name","title"),i.setAttribute("value",t.title),n.setAttribute("method","dialog"),s.classList.add("material-icons"),d.classList.add("material-icons"),s.innerText="done",d.innerText="close",s.addEventListener("click",(()=>{i.checkValidity()&&e.publish("editProject",{projId:t.id,title:i.value,description:t.value,priority:t.value})})),d.addEventListener("click",(()=>{e.publish("editProject",{projId:t.id,title:t.title,description:t.description,priority:t.value})})),c(o,[s,d]),c(n,[i,o]),n}(t))})),d.addEventListener("click",(()=>{e.publish("deleteProject",t.id)})),s.appendChild(d),s.appendChild(o),n.appendChild(i),n.appendChild(s),n}(t),d=function(t){const n=document.createElement("div"),i=document.createElement("h3"),s=document.createElement("p");return n.id="mainDescription",i.innerText="Description",""===t.description?s.innerText="Write your description here!":s.innerText=t.description,s.addEventListener("click",(()=>{e.publish("requestDescriptionEdit",function(t){const n=document.createElement("form"),i=document.createElement("textarea"),s=document.createElement("span"),d=document.createElement("span"),o=document.createElement("div");return o.id="descButtons",i.setAttribute("type","text"),i.innerText=t.description,n.setAttribute("method","dialog"),s.classList.add("material-icons"),d.classList.add("material-icons"),s.innerText="done",d.innerText="close",s.addEventListener("click",(()=>{e.publish("editProject",{projId:t.id,title:t.title,description:i.value,priority:t.value})})),d.addEventListener("click",(()=>{e.publish("editProject",{projId:t.id,title:t.title,description:t.description,priority:t.value})})),c(o,[s,d]),c(n,[i,o]),n}(t))})),n.appendChild(i),n.appendChild(s),n}(t),l=function(t){const n=document.createElement("div"),i=document.createElement("h3"),d=document.createElement("div"),l=s("add",{click:function(){e.publish("addTask",t)}});return n.id="mainTasks",i.innerText="Tasks",d.id="tasksContainer",l.innerHTML="add",l.classList.add("material-icons"),d.innerHTML="",t.tasks.forEach((n=>{d.appendChild(function(t,n){const i=a({class:["task"],id:n.id}),d=a({class:["taskContent"]});let l;n.isDone?(i.classList.add("taskCompleted"),l=s("close",{click:()=>{e.publish("incompleteTask",{projId:t.id,taskId:n.id})}})):(i.classList.remove("taskCompleted"),l=s("done",{click:()=>{e.publish("completeTask",{projId:t.id,taskId:n.id})}}));const u=o({class:["taskTitle"],text:n.name}),p=o({class:["taskDate"],text:n.date}),m=s("delete",{click:()=>{e.publish("deleteTask",{project:t,id:n.id})}});return d.addEventListener("click",(()=>{e.publish("requestTaskEdit",{taskId:n.id,form:r(t,n)})})),c(d,[u,p]),c(i,[l,d,m]),i}(t,n))})),d.appendChild(l),c(n,[i,d]),n}(t);i.appendChild(n),i.appendChild(d),i.appendChild(l)}d.addEventListener("click",(()=>{t.classList.toggle("navBarActive")})),l.addEventListener("click",(()=>{u.classList.add("formActive")}));const h=document.querySelector("nav > form > input"),f=document.querySelector("#projFormButtons > .confirm"),b=document.querySelector("#projFormButtons > .cancel");f.addEventListener("mousedown",(()=>{e.publish("addProject",h.value),u.reset(),u.classList.remove("formActive")})),b.addEventListener("click",(()=>{u.classList.remove("formActive")})),e.subscribe("todoDataChanged",(function(t){!function(t){n.innerHTML="",t.forEach((t=>{const i=function(t,n){const i=document.createElement("div"),s=document.createElement("p"),c=document.createElement("span");return i.classList.add("projectNav"),s.classList.add("projectNavTitle"),c.classList.add("material-icons"),c.addEventListener("click",(()=>{e.publish("deleteProject",t.id)})),n&&n.id===t.id&&i.classList.add("projectNavActive"),i.addEventListener("click",(()=>{!function(){const e=document.querySelector(".projectNavActive");null!==e&&e.classList.remove("projectNavActive")}(),i.classList.add("projectNavActive"),e.publish("currentProjectChanged",t)})),s.innerText=t.title,c.innerText="delete",i.id=t.id,i.appendChild(s),i.appendChild(c),i}(t,p.get());n.appendChild(i)}))}(t),m(p.get())})),e.subscribe("currentProjectChanged",(function(e){p.set(e),m(e),t.classList.toggle("navBarActive")})),e.subscribe("requestDescriptionEdit",(function(e){const t=document.querySelector("#mainDescription");t.querySelector("p").remove(),t.appendChild(e)})),e.subscribe("requestTitleEdit",(function(e){const t=document.querySelector("#mainHeader");t.innerHTML="",t.appendChild(e)})),e.subscribe("requestTaskEdit",(function(e){const t=document.querySelector(`#${e.taskId}`);t.innerHTML="",t.appendChild(e.form)}))}(),i.addProject("test1","","1"),i.addProject("test2","adsoifhsduioghasfiuoghsdifhusidghsuighdsgushsaduighsuig","3"),i.addProject("test3","adsoifhsduioghasfiuoghsdifhusidghsuighdsgushsaduighsuig","2")})();