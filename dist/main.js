(()=>{"use strict";const e=function(){const e={};function t(t){return void 0!==e[t]||(console.log(`PubSub says: "${t}" hasn't been published yet!`),!1)}return{subscribe:function(t,n){void 0===e[t]&&(e[t]=[]),e[t].push(n),console.log(e)},unsubscribe:function(n,s){if(!t(n)||!function(t,n){return!(e[t].indexOf(n)<0&&(console.log("PubSub says: no such handler found"),1))}(n,s))return;const i=e[n].indexOf(s);e[n].splice(i,1),console.log(e)},publish:function(n,s){t(n)&&e[n].forEach((e=>e(s)))}}}(),t=(e,t)=>{const n={name:e,date:t,isDone:!1,id:`taskID${Math.floor(999999*Math.random())}`},s={done(){this.isDone=!0},notDone(){this.isDone=!1},edit(e,t){this.name=e,this.date=t}};return Object.assign(Object.create(s),n)},n=(e,n,s)=>{const i={title:e,description:n,priority:s,completed:!1,id:`projID${Math.floor(999999*Math.random())}`,tasks:[t("test","domani"),t("test2","dopo domani")]},d={pushTask(e){this.tasks.push(e)},deleteTask(e){const t=this.tasks.indexOf(e);this.tasks.splice(t,1)},edit(e,t,n){this.title=e,this.description=t,this.priority=n},getTasks(){return this.tasks},checkCompleted(){const e=tasks.sort((e=>e.isDone));tasks.lenght===e.lenght&&(this.completed=!0)}};return Object.assign(Object.create(d),i)},s=function(){const t=[];function s(e){for(let n=0;n<t.length;n++)if(t[n].id===e)return n}function i(e,t){for(let n=0;n<e.tasks.length;n++)if(e.tasks[n].id===t)return n}function d(n){const i=s(n);t.splice(i,1),e.publish("todoDataChanged",t)}function a(n){const d=i(n.project,n.id),a=s(n.project.id);t[a].tasks.splice(d,1),e.publish("todoDataChanged",t)}return e.subscribe("deleteProject",d),e.subscribe("deleteTask",a),e.subscribe("completeTask",(function(n){const d=s(n.projId),a=i(t[d],n.taskId);t[d].tasks[a].done(),e.publish("todoDataChanged",t)})),e.subscribe("incompleteTask",(function(n){const d=s(n.projId),a=i(t[d],n.taskId);t[d].tasks[a].notDone(),e.publish("todoDataChanged",t)})),{addProject:function(s,i,d){const a=n(s,i,d);t.push(a),e.publish("todoDataChanged",t)},deleteProject:d,deleteTask:a}}();!function(){const t=document.querySelector("#navProjectsContainer"),n=document.querySelector("main"),s=(document.querySelector("#tasksContainer"),{data:null,set(e){this.data=e},get(){return this.data}});function i(t){if(!t)return;n.innerHTML="";const s=function(e){const t=document.createElement("div"),n=document.createElement("h2"),s=document.createElement("div"),i=document.createElement("span"),d=document.createElement("span");return t.id="mainHeader",s.id="mainButtons",i.classList.add("material-icons"),d.classList.add("material-icons"),n.innerText=e.title,i.innerText="delete",d.innerText="edit",s.appendChild(i),s.appendChild(d),t.appendChild(n),t.appendChild(s),t}(t),i=function(e){const t=document.createElement("div"),n=document.createElement("h3"),s=document.createElement("p");return t.id="mainDescription",n.innerText="Description",s.innerText=e.description,t.appendChild(n),t.appendChild(s),t}(t),d=function(t){const n=document.createElement("div"),s=document.createElement("h3"),i=document.createElement("div");return n.id="mainTasks",s.innerText="Tasks",i.id="tasksContainer",i.classList.add("taskContainer"),i.innerHTML="",t.tasks.forEach((n=>{i.appendChild(function(t,n){const s=document.createElement("div"),i=document.createElement("div"),d=document.createElement("p"),a=document.createElement("p"),o=document.createElement("span"),c=document.createElement("span");return s.classList.add("task"),i.classList.add("taskContent"),d.classList.add("taskTitle"),a.classList.add("taskDate"),o.classList.add("material-icons"),c.classList.add("material-icons"),n.isDone?(s.classList.add("taskCompleted"),c.innerText="close",c.addEventListener("click",(()=>{e.publish("incompleteTask",{projId:t.id,taskId:n.id})}))):(c.innerText="done",s.classList.remove("taskCompleted"),c.addEventListener("click",(()=>{e.publish("completeTask",{projId:t.id,taskId:n.id})}))),o.addEventListener("click",(()=>{e.publish("deleteTask",{project:t,id:n.id})})),d.innerText=n.name,a.innerText=n.date,o.innerText="delete",i.appendChild(d),i.appendChild(a),s.appendChild(c),s.appendChild(i),s.appendChild(o),s}(t,n))})),n.appendChild(s),n.appendChild(i),n}(t);n.appendChild(s),n.appendChild(i),n.appendChild(d)}e.subscribe("todoDataChanged",(function(n){console.log(n),function(n){t.innerHTML="",n.forEach((n=>{const i=function(t,n){const s=document.createElement("div"),i=document.createElement("p"),d=document.createElement("span");return s.classList.add("projectNav"),i.classList.add("projectNavTitle"),d.classList.add("material-icons"),d.addEventListener("click",(()=>{e.publish("deleteProject",t.id)})),n&&n.id===t.id&&s.classList.add("projectNavActive"),s.addEventListener("click",(()=>{!function(){const e=document.querySelector(".projectNavActive");null!==e&&e.classList.remove("projectNavActive")}(),s.classList.add("projectNavActive"),e.publish("currentProjectChanged",t)})),i.innerText=t.title,d.innerText="delete",s.id=t.id,s.appendChild(i),s.appendChild(d),s}(n,s.get());t.appendChild(i)}))}(n),i(s.get())})),e.subscribe("currentProjectChanged",(function(e){s.set(e),i(e)}))}(),s.addProject("test1","adsoifhsduioghasfiuoghsdifhusidghsuighdsgushsaduighsuig","4"),s.addProject("test2","adsoifhsduioghasfiuoghsdifhusidghsuighdsgushsaduighsuig","4"),s.addProject("test3","adsoifhsduioghasfiuoghsdifhusidghsuighdsgushsaduighsuig","4")})();